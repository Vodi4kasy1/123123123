loadstring((function(b64) local chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'; local result = ''; local val = 0; local valb = -8; for i = 1, #b64 do local c = b64:sub(i,i); if c ~= '=' then local pos = chars:find(c) - 1; val = val * 64 + pos; valb = valb + 6; if valb >= 0 then result = result .. string.char(math.floor(val / 2^valb) % 256); val = val % 2^valb; valb = valb - 8; end; end; end; return result; end)("cHJpbnQoIk1vb25MaWdodCBMb2FkaW5nLi4uIikKd2FybigiTW9vbkxpZ2h0IExvYWRpbmcuLi4iKQoKd2FpdCg1KQoKcHJpbnQoIk1vb25MaWdodCBMb2FkZWQhIikKd2FybigiTW9vbkxpZ2h0IExvYWRlZCEiKQoKd2FpdCg1KQoKbG9jYWwgQnV5THVja3kgPSB0cnVlCmxvY2FsIEF1dG9TZWxsID0gdHJ1ZQpsb2NhbCBTZWxsSXRlbXMgPSB7CiAgICBbIkdvbGQgQ29pbiJdID0gdHJ1ZSwKICAgIFsiUm9rYWtha2EiXSA9IHRydWUsCiAgICBbIlB1cmUgUm9rYWtha2EiXSA9IHRydWUsCiAgICBbIk15c3RlcmlvdXMgQXJyb3ciXSA9IHRydWUsCiAgICBbIkRpYW1vbmQiXSA9IHRydWUsCiAgICBbIkFuY2llbnQgU2Nyb2xsIl0gPSB0cnVlLAogICAgWyJDYWVzYXIncyBIZWFkYmFuZCJdID0gdHJ1ZSwKICAgIFsiU3RvbmUgTWFzayJdID0gdHJ1ZSwKICAgIFsiUmliIENhZ2Ugb2YgVGhlIFNhaW50J3MgQ29ycHNlIl0gPSB0cnVlLAogICAgWyJRdWludG9uJ3MgR2xvdmUiXSA9IHRydWUsCiAgICBbIlplcHBlbGkncyBIYXQiXSA9IHRydWUsCiAgICBbIkx1Y2t5IEFycm93Il0gPSBmYWxzZSwKICAgIFsiQ2xhY2tlcnMiXSA9IHRydWUsCiAgICBbIlN0ZWVsIEJhbGwiXSA9IHRydWUsCiAgICBbIkRpbydzIERpYXJ5Il0gPSB0cnVlCn0KCmxvY2FsIFdvcmtzcGFjZSA9IGdhbWU6R2V0U2VydmljZSgiV29ya3NwYWNlIikKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBNYXJrZXRwbGFjZVNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIk1hcmtldHBsYWNlU2VydmljZSIpCgpsb2NhbCBQbGF5ZXIgPSBQbGF5ZXJzLkxvY2FsUGxheWVyCmxvY2FsIFBsYXllckd1aSA9IFBsYXllcjpXYWl0Rm9yQ2hpbGQoIlBsYXllckd1aSIpCgpnYW1lOkdldFNlcnZpY2UoIkNvcmVHdWkiKS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgIGlmIGNoaWxkLk5hbWUgPT0gIkVycm9yUHJvbXB0IiB0aGVuCiAgICAgICAgbG9jYWwgR3JhYkVycm9yID0gY2hpbGQ6RmluZEZpcnN0Q2hpbGQoIkVycm9yTWVzc2FnZSIsdHJ1ZSkKICAgICAgICByZXBlYXQgdGFzay53YWl0KCkgdW50aWwgR3JhYkVycm9yLlRleHQgfj0gIkxhYmVsIgogICAgICAgIGxvY2FsIFJlYXNvbiA9IEdyYWJFcnJvci5UZXh0CiAgICAgICAgaWYgUmVhc29uOm1hdGNoKCJraWNrIikgb3IgUmVhc29uOm1hdGNoKCJZb3UiKSBvciBSZWFzb246bWF0Y2goImNvbm4iKSBvciBSZWFzb246bWF0Y2goInJlam9pbiIpIHRoZW4KICAgICAgICAgICAgZ2FtZTpHZXRTZXJ2aWNlKCJUZWxlcG9ydFNlcnZpY2UiKTpUZWxlcG9ydCgyODA5MjAyMTU1LCBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcikKICAgICAgICBlbmQKICAgIGVuZAplbmQpCgpsb2NhbCBIYXMyeCA9IE1hcmtldHBsYWNlU2VydmljZTpVc2VyT3duc0dhbWVQYXNzQXN5bmMoUGxheWVyLlVzZXJJZCwgMTQ1OTc3NzgpCgpsb2NhbCBvbGRNYWduaXR1ZGUKb2xkTWFnbml0dWRlID0gaG9va21ldGFtZXRob2QoVmVjdG9yMy5uZXcoKSwgIl9faW5kZXgiLCBuZXdjY2xvc3VyZShmdW5jdGlvbihzZWxmLCBpbmRleCkKICAgIGxvY2FsIENhbGxpbmdTY3JpcHQgPSB0b3N0cmluZyhnZXRjYWxsaW5nc2NyaXB0KCkpCgogICAgaWYgbm90IGNoZWNrY2FsbGVyKCkgYW5kIGluZGV4ID09ICJtYWduaXR1ZGUiIGFuZCBDYWxsaW5nU2NyaXB0ID09ICJJdGVtU3Bhd24iIHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZW5kCgogICAgcmV0dXJuIG9sZE1hZ25pdHVkZShzZWxmLCBpbmRleCkKZW5kKSkKCmxvY2FsIEl0ZW1TcGF3bkZvbGRlciA9IFdvcmtzcGFjZTpXYWl0Rm9yQ2hpbGQoIkl0ZW1fU3Bhd25zIik6V2FpdEZvckNoaWxkKCJJdGVtcyIpCgpsb2NhbCBmdW5jdGlvbiBHZXRDaGFyYWN0ZXIoUGFydCkKICAgIGlmIFBsYXllci5DaGFyYWN0ZXIgdGhlbgogICAgICAgIGlmIG5vdCBQYXJ0IHRoZW4KICAgICAgICAgICAgcmV0dXJuIFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBlbHNlaWYgdHlwZW9mKFBhcnQpID09ICJzdHJpbmciIHRoZW4KICAgICAgICAgICAgcmV0dXJuIFBsYXllci5DaGFyYWN0ZXI6RmluZEZpcnN0Q2hpbGQoUGFydCkgb3IgbmlsCiAgICAgICAgZW5kCiAgICBlbmQKCiAgICByZXR1cm4gbmlsCmVuZAoKbG9jYWwgZnVuY3Rpb24gVGVsZXBvcnRUbyhQb3NpdGlvbikKICAgIGxvY2FsIEh1bWFub2lkUm9vdFBhcnQgPSBHZXRDaGFyYWN0ZXIoIkh1bWFub2lkUm9vdFBhcnQiKQoKICAgIGlmIEh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgIGxvY2FsIFBvc2l0aW9uVHlwZSA9IHR5cGVvZihQb3NpdGlvbikKCiAgICAgICAgaWYgUG9zaXRpb25UeXBlID09ICJDRnJhbWUiIHRoZW4KICAgICAgICAgICAgSHVtYW5vaWRSb290UGFydC5DRnJhbWUgPSBQb3NpdGlvbgogICAgICAgIGVuZAogICAgZW5kCmVuZAoKbG9jYWwgZnVuY3Rpb24gVG9nZ2xlTm9jbGlwKFZhbHVlKQogICAgbG9jYWwgQ2hhcmFjdGVyID0gR2V0Q2hhcmFjdGVyKCkKCiAgICBpZiBDaGFyYWN0ZXIgdGhlbgogICAgICAgIGZvciBfLCBDaGlsZCBpbiBwYWlycyhDaGFyYWN0ZXI6R2V0RGVzY2VuZGFudHMoKSkgZG8KICAgICAgICAgICAgaWYgQ2hpbGQ6SXNBKCJCYXNlUGFydCIpIGFuZCBDaGlsZC5DYW5Db2xsaWRlID09IG5vdCBWYWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBDaGlsZC5DYW5Db2xsaWRlID0gVmFsdWUKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBNYXhJdGVtQW1vdW50cyA9IHsKICAgIFsiR29sZCBDb2luIl0gPSA0NSwKICAgIFsiUm9rYWtha2EiXSA9IDI1LAogICAgWyJQdXJlIFJva2FrYWthIl0gPSAxMCwKICAgIFsiTXlzdGVyaW91cyBBcnJvdyJdID0gMjUsCiAgICBbIkRpYW1vbmQiXSA9IDMwLAogICAgWyJBbmNpZW50IFNjcm9sbCJdID0gMTAsCiAgICBbIkNhZXNhcidzIEhlYWRiYW5kIl0gPSAxMCwKICAgIFsiU3RvbmUgTWFzayJdID0gMTAsCiAgICBbIlJpYiBDYWdlIG9mIFRoZSBTYWludCdzIENvcnBzZSJdID0gMjAsCiAgICBbIlF1aW50b24ncyBHbG92ZSJdID0gMTAsCiAgICBbIlplcHBlbGkncyBIYXQiXSA9IDEwLAogICAgWyJMdWNreSBBcnJvdyJdID0gMTAsCiAgICBbIkNsYWNrZXJzIl0gPSAxMCwKICAgIFsiU3RlZWwgQmFsbCJdID0gMTAsCiAgICBbIkRpbydzIERpYXJ5Il0gPSAxMAp9CgppZiBIYXMyeCB0aGVuCiAgICBmb3IgSW5kZXgsIE1heCBpbiBwYWlycyhNYXhJdGVtQW1vdW50cykgZG8KICAgICAgICBNYXhJdGVtQW1vdW50c1tJbmRleF0gPSBNYXggKiAyCiAgICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBIYXNNYXhJdGVtKEl0ZW0pCiAgICBsb2NhbCBDb3VudCA9IDAKCiAgICBmb3IgXywgVG9vbCBpbiBwYWlycyhQbGF5ZXIuQmFja3BhY2s6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBUb29sLk5hbWUgPT0gSXRlbSB0aGVuCiAgICAgICAgICAgIENvdW50ICs9IDEKICAgICAgICBlbmQKICAgIGVuZAoKICAgIGlmIE1heEl0ZW1BbW91bnRzW0l0ZW1dIHRoZW4KICAgICAgICByZXR1cm4gQ291bnQgPj0gTWF4SXRlbUFtb3VudHNbSXRlbV0KICAgIGVsc2UKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAplbmQKCmxvY2FsIFRlbGVwb3J0ID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yaW5xZWRkL3B1Yl9yYmx4L21haW4vU2VydmVySG9wIiwgdHJ1ZSkpCgpsb2NhbCBmdW5jdGlvbiBHZXRJdGVtSW5mbyhNb2RlbCkKICAgIGlmIE1vZGVsIGFuZCBNb2RlbDpJc0EoIk1vZGVsIikgYW5kIE1vZGVsLlBhcmVudCBhbmQgTW9kZWwuUGFyZW50Lk5hbWUgPT0gIkl0ZW1zIiB0aGVuCiAgICAgICAgbG9jYWwgUHJpbWFyeVBhcnQgPSBNb2RlbC5QcmltYXJ5UGFydAogICAgICAgIGxvY2FsIFBvc2l0aW9uID0gUHJpbWFyeVBhcnQuUG9zaXRpb24KICAgICAgICBsb2NhbCBQcm94aW1pdHlQcm9tcHQKCiAgICAgICAgZm9yIF8sIEl0ZW1JbnN0YW5jZSBpbiBwYWlycyhNb2RlbDpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiBJdGVtSW5zdGFuY2U6SXNBKCJQcm94aW1pdHlQcm9tcHQiKSBhbmQgSXRlbUluc3RhbmNlLk1heEFjdGl2YXRpb25EaXN0YW5jZSA9PSA4IHRoZW4KICAgICAgICAgICAgICAgIFByb3hpbWl0eVByb21wdCA9IEl0ZW1JbnN0YW5jZQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKCiAgICAgICAgaWYgUHJveGltaXR5UHJvbXB0IHRoZW4KICAgICAgICAgICAgcmV0dXJuIHtbIk5hbWUiXSA9IFByb3hpbWl0eVByb21wdC5PYmplY3RUZXh0LCBbIlByb3hpbWl0eVByb21wdCJdID0gUHJveGltaXR5UHJvbXB0LCBbIlBvc2l0aW9uIl0gPSBQb3NpdGlvbn0KICAgICAgICBlbmQKICAgIGVuZAoKICAgIHJldHVybiBuaWwKZW5kCgpnZXRnZW52KCkuU3Bhd25lZEl0ZW1zID0ge30KCkl0ZW1TcGF3bkZvbGRlci5DaGlsZEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oTW9kZWwpCiAgICB0YXNrLndhaXQoMSkKICAgIGlmIE1vZGVsOklzQSgiTW9kZWwiKSB0aGVuCiAgICAgICAgbG9jYWwgSXRlbUluZm8gPSBHZXRJdGVtSW5mbyhNb2RlbCkKCiAgICAgICAgaWYgSXRlbUluZm8gdGhlbgogICAgICAgICAgICBnZXRnZW52KCkuU3Bhd25lZEl0ZW1zW01vZGVsXSA9IEl0ZW1JbmZvCiAgICAgICAgZW5kCiAgICBlbmQKZW5kKQoKbG9jYWwgVXp1S2VlSXNSZXRhcmRlZEFuZERvZXNudEtub3dIb3dUb01ha2VBbkFudGlDaGVhdE9uVGhlU2VydmVyU2lkZUFsc29WZXhTdGZ1SUtub3dUaGVDb2RlSXNCYWRZb3VEb250TmVlZFRvVGVsbE1lID0gIiAgX19fWFAgREUgS0VZIgoKbG9jYWwgb2xkTmMKb2xkTmMgPSBob29rbWV0YW1ldGhvZChnYW1lLCAiX19uYW1lY2FsbCIsIG5ld2NjbG9zdXJlKGZ1bmN0aW9uKHNlbGYsIC4uLikKICAgIGxvY2FsIE1ldGhvZCA9IGdldG5hbWVjYWxsbWV0aG9kKCkKICAgIGxvY2FsIEFyZ3MgPSB7Li4ufQoKICAgIGlmIG5vdCBjaGVja2NhbGxlcigpIGFuZCByYXdlcXVhbChzZWxmLk5hbWUsICJSZXR1cm5lciIpIGFuZCByYXdlcXVhbChBcmdzWzFdLCAiaWRrbG9sYnJhaDJkZSIpIHRoZW4KICAgICAgICByZXR1cm4gVXp1S2VlSXNSZXRhcmRlZEFuZERvZXNudEtub3dIb3dUb01ha2VBbkFudGlDaGVhdE9uVGhlU2VydmVyU2lkZUFsc29WZXhTdGZ1SUtub3dUaGVDb2RlSXNCYWRZb3VEb250TmVlZFRvVGVsbE1lCiAgICBlbmQKCiAgICByZXR1cm4gb2xkTmMoc2VsZiwgLi4uKQplbmQpKQoKdGFzay53YWl0KDEpCgppZiBub3QgUGxheWVyR3VpOkZpbmRGaXJzdENoaWxkKCJIVUQiKSB0aGVuCiAgICBsb2NhbCBIVUQgPSBSZXBsaWNhdGVkU3RvcmFnZS5PYmplY3RzLkhVRDpDbG9uZSgpCiAgICBIVUQuUGFyZW50ID0gUGxheWVyR3VpCmVuZAoKdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICBQbGF5ZXJHdWk6V2FpdEZvckNoaWxkKCJMb2FkaW5nU2NyZWVuMSIpOkRlc3Ryb3koKQoKICAgIHRhc2sud2FpdCguNSkKCiAgICBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgUGxheWVyR3VpOldhaXRGb3JDaGlsZCgiTG9hZGluZ1NjcmVlbiIpOkRlc3Ryb3koKQogICAgZW5kKQoKICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICB3b3Jrc3BhY2UuTG9hZGluZ1NjcmVlbi5Tb25nOkRlc3Ryb3koKQogICAgZW5kKQplbmQpCgpyZXBlYXQgdGFzay53YWl0KCkgdW50aWwgR2V0Q2hhcmFjdGVyKCkgYW5kIEdldENoYXJhY3RlcigiUmVtb3RlRXZlbnQiKQoKR2V0Q2hhcmFjdGVyKCJSZW1vdGVFdmVudCIpOkZpcmVTZXJ2ZXIoIlByZXNzZWRQbGF5IikKClRlbGVwb3J0VG8oQ0ZyYW1lLm5ldyg5NzgsIC00MiwgLTQ5KSkKCnRhc2sud2FpdCg1KQoKcmVwZWF0CiAgICBmb3IgSW5kZXgsIEl0ZW1JbmZvIGluIHBhaXJzKGdldGdlbnYoKS5TcGF3bmVkSXRlbXMpIGRvCiAgICAgICAgbG9jYWwgSHVtYW5vaWRSb290UGFydCA9IEdldENoYXJhY3RlcigiSHVtYW5vaWRSb290UGFydCIpCgogICAgICAgIGlmIEh1bWFub2lkUm9vdFBhcnQgdGhlbgogICAgICAgICAgICBsb2NhbCBOYW1lID0gSXRlbUluZm8uTmFtZQoKICAgICAgICAgICAgbG9jYWwgSGFzTWF4ID0gSGFzTWF4SXRlbShOYW1lKQoKICAgICAgICAgICAgaWYgbm90IEhhc01heCB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBQcm94aW1pdHlQcm9tcHQgPSBJdGVtSW5mby5Qcm94aW1pdHlQcm9tcHQKICAgICAgICAgICAgICAgIGxvY2FsIFBvc2l0aW9uID0gSXRlbUluZm8uUG9zaXRpb24KCiAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUoZ2V0Z2VudigpLlNwYXduZWRJdGVtcywgdGFibGUuZmluZChnZXRnZW52KCkuU3Bhd25lZEl0ZW1zLCBJdGVtSW5mbykpCgogICAgICAgICAgICAgICAgbG9jYWwgQm9keVZlbG9jaXR5ID0gSW5zdGFuY2UubmV3KCJCb2R5VmVsb2NpdHkiKQogICAgICAgICAgICAgICAgQm9keVZlbG9jaXR5LlBhcmVudCA9IEh1bWFub2lkUm9vdFBhcnQKICAgICAgICAgICAgICAgIEJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IFZlY3RvcjMubmV3KDAsIDAsIDApCgogICAgICAgICAgICAgICAgVG9nZ2xlTm9jbGlwKHRydWUpCiAgICAgICAgICAgICAgICBUZWxlcG9ydFRvKENGcmFtZS5uZXcoUG9zaXRpb24uWCwgUG9zaXRpb24uWSArIDI1LCBQb3NpdGlvbi5aKSkKCiAgICAgICAgICAgICAgICB0YXNrLndhaXQoLjUpCiAgICAgICAgICAgICAgICBmaXJlcHJveGltaXR5cHJvbXB0KFByb3hpbWl0eVByb21wdCkKICAgICAgICAgICAgICAgIHRhc2sud2FpdCguNSkKCiAgICAgICAgICAgICAgICBCb2R5VmVsb2NpdHk6RGVzdHJveSgpCgogICAgICAgICAgICAgICAgVGVsZXBvcnRUbyhDRnJhbWUubmV3KDk3OCwgLTQyLCAtNDkpKQoKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGFibGUucmVtb3ZlKGdldGdlbnYoKS5TcGF3bmVkSXRlbXMsIHRhYmxlLmZpbmQoZ2V0Z2VudigpLlNwYXduZWRJdGVtcywgSXRlbUluZm8pKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAoKICAgIHRhc2sud2FpdCgzKQp1bnRpbCAjZ2V0Z2VudigpLlNwYXduZWRJdGVtcyA9PSAwCgppZiBBdXRvU2VsbCB0aGVuCiAgICBmb3IgSXRlbSwgU2VsbCBpbiBwYWlycyhTZWxsSXRlbXMpIGRvCiAgICAgICAgaWYgU2VsbCBhbmQgUGxheWVyLkJhY2twYWNrIGFuZCBQbGF5ZXIuQmFja3BhY2s6RmluZEZpcnN0Q2hpbGQoSXRlbSkgdGhlbgogICAgICAgICAgICBHZXRDaGFyYWN0ZXIoIkh1bWFub2lkIik6RXF1aXBUb29sKFBsYXllci5CYWNrcGFjazpGaW5kRmlyc3RDaGlsZChJdGVtKSkKCiAgICAgICAgICAgIEdldENoYXJhY3RlcigiUmVtb3RlRXZlbnQiKTpGaXJlU2VydmVyKCJFbmREaWFsb2d1ZSIsIHsKICAgICAgICAgICAgICAgIFsiTlBDIl0gPSAiTWVyY2hhbnQiLAogICAgICAgICAgICAgICAgWyJEaWFsb2d1ZSJdID0gIkRpYWxvZ3VlNSIsCiAgICAgICAgICAgICAgICBbIk9wdGlvbiJdID0gIk9wdGlvbjIiCiAgICAgICAgICAgIH0pCgogICAgICAgICAgICB0YXNrLndhaXQoLjEpCiAgICAgICAgZW5kCiAgICBlbmQKZW5kCgpsb2NhbCBNb25leSA9IFBsYXllci5QbGF5ZXJTdGF0cy5Nb25leQoKaWYgQnV5THVja3kgdGhlbgogICAgd2hpbGUgTW9uZXkuVmFsdWUgPj0gNTAwMDAgZG8KICAgICAgICBQbGF5ZXIuQ2hhcmFjdGVyLlJlbW90ZUV2ZW50OkZpcmVTZXJ2ZXIoIlB1cmNoYXNlU2hvcEl0ZW0iLCB7WyJJdGVtTmFtZSJdID0gIjF4IEx1Y2t5IEFycm93In0pCiAgICAgICAgdGFzay53YWl0KC4xKQogICAgZW5kCmVuZAoKd2hpbGUgdHJ1ZSBkbwogICAgVGVsZXBvcnQoKQoKICAgIHRhc2sud2FpdCgzKQplbmQ="))()
